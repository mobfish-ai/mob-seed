---
status: archived
created: 2026-01-04
archived: 2026-01-04
architecture_decisions_completed: true
---

# è¿è¡Œæ—¶ç‰ˆæœ¬ç®¡ç† è§„æ ¼

> ç‰ˆæœ¬: 1.0.0
> åˆ›å»ºæ—¶é—´: 2026-01-04
> æœ€åæ›´æ–°: 2026-01-04
> æ¨¡æ¿: feature

---

## æ¦‚è¿° (Overview)

### åŠŸèƒ½æè¿°
æä¾›è¿è¡Œæ—¶ç‰ˆæœ¬ä¿¡æ¯å±•ç¤ºå’Œæ›´æ–°ç®¡ç†èƒ½åŠ›ï¼Œåœ¨å‘½ä»¤æ‰§è¡Œæ—¶æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬ã€è¿è¡Œåœºæ™¯ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦æœ‰æ–°ç‰ˆæœ¬å¯ç”¨ã€‚

### ç›®æ ‡ç”¨æˆ·
- mob-seed ç”¨æˆ·
- å¸Œæœ›äº†è§£å½“å‰ç‰ˆæœ¬å’Œæ›´æ–°çŠ¶æ€çš„å¼€å‘è€…

### æ ¸å¿ƒä»·å€¼
- æ¸…æ™°å±•ç¤ºå½“å‰ä½¿ç”¨çš„ç‰ˆæœ¬å’Œè¿è¡Œåœºæ™¯
- åŠæ—¶è·çŸ¥æ–°ç‰ˆæœ¬å‘å¸ƒ
- ç®€åŒ–æ›´æ–°æµç¨‹

### ä½¿ç”¨åœºæ™¯
- åœºæ™¯1: ç”¨æˆ·è¿è¡Œä»»æ„ `/mob-seed:*` å‘½ä»¤æ—¶ï¼Œæ˜¾ç¤ºç‰ˆæœ¬å·å’Œè¿è¡Œåœºæ™¯
- åœºæ™¯2: Git hooks (pre-commit, pre-push) æ‰§è¡Œæ—¶æ˜¾ç¤ºç‰ˆæœ¬å·å’Œåœºæ™¯
- åœºæ™¯3: æœ‰æ–°ç‰ˆæœ¬æ—¶ï¼Œæç¤ºç”¨æˆ·æ›´æ–°
- åœºæ™¯4: ç”¨æˆ·æ‰‹åŠ¨æ£€æŸ¥ç‰ˆæœ¬ `/mob-seed --version`
- åœºæ™¯5: ç”¨æˆ·æ‰§è¡Œæ›´æ–° `/mob-seed --update`

> **å…³é”®åŸåˆ™**: ä»»ä½•è§¦å‘ mob-seed çš„å…¥å£ï¼ˆå‘½ä»¤ã€æŠ€èƒ½ã€hooksï¼‰éƒ½å¿…é¡»æ˜¾ç¤ºç‰ˆæœ¬å·å’Œåœºæ™¯ï¼Œæ–¹ä¾¿ç”¨æˆ·çŸ¥æ™“å½“å‰è¿è¡Œç¯å¢ƒã€‚

---

## æ¶æ„å†³ç­–æ£€æŸ¥æ¸…å• (Architecture Decisions)

> å·²å®Œæˆæ‰€æœ‰æ¶æ„å†³ç­–ã€‚

### 1. ç›®å½•ç»“æ„è®¾è®¡

**é€‰æ‹©**: æŒ‰åŠŸèƒ½åˆ†å±‚ - `lib/runtime/`

**ç†ç”±**: ç‰ˆæœ¬ç®¡ç†æ˜¯è¿è¡Œæ—¶åŠŸèƒ½ï¼Œä¸ç°æœ‰ hooks/ æ¨¡å—åˆ†ç¦»

---

### 2. å‘½åè§„èŒƒ

**é€‰æ‹©**: å¯¹è±¡-åŠ¨è¯æ¨¡å¼ - `version-checker.js`, `version-updater.js`

**ç†ç”±**: ä¸ç°æœ‰ hooks/ æ¨¡å—å‘½åä¸€è‡´ï¼ˆcache-checker, cache-updaterï¼‰

---

### 3. åº“ä¸ CLI åˆ†ç¦»

**é€‰æ‹©**: æ˜¯ - åˆ†ç¦»

- åº“å‡½æ•°ï¼š`lib/runtime/version-checker.js`
- åœºæ™¯é›†æˆï¼šå¤ç”¨ `lib/hooks/scenario.js`

**é€‚ç”¨åœºæ™¯**: ç‰ˆæœ¬æ£€æŸ¥é€»è¾‘å¯è¢« hooks å’Œå‘½ä»¤å…±ç”¨

---

### 4. é”™è¯¯å¤„ç†ç­–ç•¥

**é€‰æ‹©**: ä¼˜é›…é™çº§

**é™çº§è·¯å¾„**:
- ç½‘ç»œå¤±è´¥ â†’ è·³è¿‡è¿œç¨‹ç‰ˆæœ¬æ£€æŸ¥ï¼Œåªæ˜¾ç¤ºæœ¬åœ°ç‰ˆæœ¬
- ç¼“å­˜å¤±è´¥ â†’ æ¯æ¬¡éƒ½æ£€æŸ¥è¿œç¨‹
- è§£æå¤±è´¥ â†’ æ˜¾ç¤º "unknown" ç‰ˆæœ¬

---

### 5. é€€å‡ºç è®¾è®¡

**é€‰æ‹©**: ä¸å…³å¿ƒé€€å‡ºç 

**ç†ç”±**: ç‰ˆæœ¬æ£€æŸ¥ä¸å½±å“å‘½ä»¤æ‰§è¡Œç»“æœ

---

### 6. Git Hooks é›†æˆæ–¹å¼

**é€‰æ‹©**: å¤ç”¨ç°æœ‰åœºæ™¯æ£€æµ‹

**ç­–ç•¥**: åœ¨ hooks è¾“å‡ºä¸­å¢åŠ ç‰ˆæœ¬å·æ˜¾ç¤º

---

### 7. æµ‹è¯•è¦†ç›–ç‡è¦æ±‚

**é€‰æ‹©**: æŒ‰é£é™©åˆ†çº§

**é£é™©åˆ†çº§**:
- ğŸ”´ High Risk (â‰¥95%): ç‰ˆæœ¬æ¯”è¾ƒé€»è¾‘
- ğŸŸ¡ Medium Risk (â‰¥85%): è¿œç¨‹æ£€æŸ¥ã€ç¼“å­˜æœºåˆ¶
- ğŸŸ¢ Low Risk (â‰¥75%): æ ¼å¼åŒ–è¾“å‡º

---

### 8. åºŸå¼ƒç­–ç•¥

**é€‰æ‹©**: ä¸éœ€è¦åºŸå¼ƒï¼ˆæ–°åŠŸèƒ½ï¼‰

---

## éœ€æ±‚ (Requirements)

### åŠŸèƒ½éœ€æ±‚ (Functional Requirements)

- [x] FR-001: è¯»å–æœ¬åœ°ç‰ˆæœ¬å·ï¼ˆä» package.jsonï¼‰
- [x] FR-002: æ£€æŸ¥è¿œç¨‹æœ€æ–°ç‰ˆæœ¬ï¼ˆä» npm registryï¼‰
- [x] FR-003: ç¼“å­˜è¿œç¨‹ç‰ˆæœ¬æ£€æŸ¥ç»“æœï¼ˆé¿å…é¢‘ç¹è¯·æ±‚ï¼‰
- [x] FR-004: **æ‰€æœ‰ mob-seed è¿è¡Œæ—¶å…¥å£**ç»Ÿä¸€æ˜¾ç¤ºç‰ˆæœ¬å·å’Œåœºæ™¯
  - [x] FR-004a: Git hooks (pre-commit, pre-push)
  - [x] FR-004b: å‘½ä»¤å…¥å£ (/mob-seed:spec, /mob-seed:emit, /mob-seed:exec, /mob-seed:defend, /mob-seed:archive)
  - [x] FR-004c: ç»Ÿä¸€å…¥å£ (/mob-seed)
  - [x] FR-004d: æŠ€èƒ½è°ƒç”¨ (Skill tool)
- [x] FR-005: æœ‰æ–°ç‰ˆæœ¬æ—¶æ˜¾ç¤ºæ›´æ–°æç¤º
- [x] FR-006: æä¾› `--version` å‚æ•°æ˜¾ç¤ºè¯¦ç»†ç‰ˆæœ¬ä¿¡æ¯
- [x] FR-007: æä¾› `--update` å‚æ•°æ‰§è¡Œæ›´æ–°

### éåŠŸèƒ½éœ€æ±‚ (Non-Functional Requirements)

- [x] NFR-001: æ€§èƒ½ - ç‰ˆæœ¬æ£€æŸ¥ä¸å½±å“å‘½ä»¤å¯åŠ¨æ—¶é—´ï¼ˆå¼‚æ­¥ + ç¼“å­˜ï¼‰
- [x] NFR-002: å¯ç”¨æ€§ - ç¦»çº¿ç¯å¢ƒä¸‹æ­£å¸¸å·¥ä½œï¼ˆè·³è¿‡è¿œç¨‹æ£€æŸ¥ï¼‰
- [x] NFR-003: ç”¨æˆ·ä½“éªŒ - æ›´æ–°æç¤ºç®€æ´ä¸å¹²æ‰°ï¼ˆå•è¡Œï¼‰

---

## çº¦æŸ (Constraints)

### æŠ€æœ¯çº¦æŸ
- æŠ€æœ¯æ ˆ: Node.js, CommonJS
- å…¼å®¹æ€§: Node.js 18+
- ä¾èµ–: ä½¿ç”¨å†…ç½® https æ¨¡å—ï¼Œæ— éœ€é¢å¤–ä¾èµ–

### ä¸šåŠ¡çº¦æŸ
- æ£€æŸ¥é—´éš”: é»˜è®¤ 24 å°æ—¶ï¼Œå¯é…ç½®
- æ›´æ–°æ–¹å¼: ä»…æç¤ºï¼Œä¸å¼ºåˆ¶

### èµ„æºçº¦æŸ
- èŒƒå›´: ä»…æ”¯æŒ npm registry æ£€æŸ¥

---

## éªŒæ”¶æ ‡å‡† (Acceptance Criteria)

### AC-001: å‘½ä»¤å…¥å£æ˜¾ç¤ºç‰ˆæœ¬å’Œåœºæ™¯
- **Given**: ç”¨æˆ·è¿è¡Œä»»æ„ `/mob-seed:*` å‘½ä»¤
- **When**: å‘½ä»¤å¼€å§‹æ‰§è¡Œ
- **Then**:
  - æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬å·ï¼ˆå¦‚ `v3.5.0`ï¼‰
  - æ˜¾ç¤ºè¿è¡Œåœºæ™¯ï¼ˆå¦‚ `[å¼€å‘æ¨¡å¼] mob-seed dogfooding`ï¼‰
  - æ ¼å¼: `ğŸŒ± mob-seed v3.5.0 [å¼€å‘æ¨¡å¼] mob-seed dogfooding`

### AC-001a: Git Hooks æ˜¾ç¤ºç‰ˆæœ¬å’Œåœºæ™¯
- **Given**: Git hook (pre-commit/pre-push) è¢«è§¦å‘
- **When**: hook å¼€å§‹æ‰§è¡Œ SEED æ£€æŸ¥
- **Then**:
  - åœ¨æ£€æŸ¥æç¤ºä¸­åŒ…å«ç‰ˆæœ¬å·
  - æ ¼å¼: `ğŸ” SEED å¿«é€Ÿæ£€æŸ¥... v3.5.0 [å¼€å‘æ¨¡å¼] mob-seed dogfooding`
  - æˆ–: `ğŸ” SEED å¢é‡æ£€æŸ¥... v3.5.0 [ç”¨æˆ·é¡¹ç›®] Claude Code æ’ä»¶`

### AC-002: æ£€æŸ¥è¿œç¨‹æœ€æ–°ç‰ˆæœ¬
- **Given**: ç”¨æˆ·è¿è¡Œ mob-seed å‘½ä»¤ä¸”è·ä¸Šæ¬¡æ£€æŸ¥è¶…è¿‡ 24 å°æ—¶
- **When**: å‘½ä»¤å¼€å§‹æ‰§è¡Œ
- **Then**:
  - å¼‚æ­¥æ£€æŸ¥ npm registry è·å–æœ€æ–°ç‰ˆæœ¬
  - å°†ç»“æœç¼“å­˜åˆ° `.seed/cache/version.json`
  - ä¸é˜»å¡å‘½ä»¤æ‰§è¡Œ

### AC-003: æ˜¾ç¤ºæ›´æ–°æç¤ºï¼ˆæ ¹æ®å®‰è£…åœºæ™¯ï¼‰
- **Given**: æ£€æµ‹åˆ°æœ‰æ–°ç‰ˆæœ¬å¯ç”¨
- **When**: å‘½ä»¤æ‰§è¡Œå®Œæˆå
- **Then**:
  - æ ¹æ®è¿è¡Œåœºæ™¯æ˜¾ç¤ºå¯¹åº”çš„æ›´æ–°å‘½ä»¤:
    - `user-plugin`: `ğŸ’¡ æ–°ç‰ˆæœ¬ v3.6.0 å¯ç”¨ï¼Œè¿è¡Œ claude plugins update mob-seed æ›´æ–°`
    - `user-env`: `ğŸ’¡ æ–°ç‰ˆæœ¬ v3.6.0 å¯ç”¨ï¼Œè¿è¡Œ npm update -g mob-seed æ›´æ–°`
    - `dogfooding`: `ğŸ’¡ æ–°ç‰ˆæœ¬ v3.6.0 å¯ç”¨ï¼Œè¿è¡Œ git pull æ›´æ–°`
  - æç¤ºä¸ºå•è¡Œï¼Œä¸å¹²æ‰°ä¸»è¦è¾“å‡º

### AC-004: ç¦»çº¿ç¯å¢ƒä¼˜é›…é™çº§
- **Given**: ç”¨æˆ·åœ¨ç¦»çº¿ç¯å¢ƒä¸‹è¿è¡Œå‘½ä»¤
- **When**: è¿œç¨‹ç‰ˆæœ¬æ£€æŸ¥å¤±è´¥
- **Then**:
  - é™é»˜è·³è¿‡è¿œç¨‹æ£€æŸ¥
  - åªæ˜¾ç¤ºæœ¬åœ°ç‰ˆæœ¬
  - ä¸æ˜¾ç¤ºä»»ä½•é”™è¯¯ä¿¡æ¯

### AC-005: --version å‚æ•°
- **Given**: ç”¨æˆ·è¿è¡Œ `mob-seed --version`
- **When**: å‘½ä»¤æ‰§è¡Œ
- **Then**:
  - æ˜¾ç¤ºè¯¦ç»†ç‰ˆæœ¬ä¿¡æ¯:
    ```
    mob-seed v3.5.0
    Node.js v20.10.0
    Platform: darwin arm64
    åœºæ™¯: [å¼€å‘æ¨¡å¼] mob-seed dogfooding
    æœ€æ–°ç‰ˆæœ¬: v3.5.0 (å·²æ˜¯æœ€æ–°)
    ```

### AC-006: ç‰ˆæœ¬æ£€æŸ¥ç¼“å­˜
- **Given**: ç”¨æˆ·åœ¨ 24 å°æ—¶å†…å¤šæ¬¡è¿è¡Œå‘½ä»¤
- **When**: æ¯æ¬¡å‘½ä»¤æ‰§è¡Œ
- **Then**:
  - å¤ç”¨ç¼“å­˜çš„ç‰ˆæœ¬æ£€æŸ¥ç»“æœ
  - ä¸å‘èµ·é‡å¤çš„ç½‘ç»œè¯·æ±‚

---

## æ´¾ç”Ÿäº§ç‰© (Derived Outputs)

> **è·¯å¾„è§„èŒƒ**: æ‰€æœ‰è·¯å¾„éµå¾ª `.seed/config.json` ä¸­çš„ `paths` é…ç½®ã€‚

| ç±»å‹ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| ä»£ç  | skills/mob-seed/lib/runtime/version-checker.js | ç‰ˆæœ¬æ£€æŸ¥æ ¸å¿ƒ |
| ä»£ç  | skills/mob-seed/lib/runtime/version-display.js | ç‰ˆæœ¬æ˜¾ç¤ºæ ¼å¼åŒ– |
| ä»£ç  | skills/mob-seed/lib/runtime/version-updater.js | ç‰ˆæœ¬æ›´æ–°æ‰§è¡Œå™¨ |
| ä»£ç  | skills/mob-seed/lib/runtime/index.js | æ¨¡å—å¯¼å‡º |
| æµ‹è¯• | skills/mob-seed/test/runtime/version-checker.test.js | ç‰ˆæœ¬æ£€æŸ¥æµ‹è¯• |
| æµ‹è¯• | skills/mob-seed/test/runtime/version-display.test.js | ç‰ˆæœ¬æ˜¾ç¤ºæµ‹è¯• |
| æµ‹è¯• | skills/mob-seed/test/runtime/version-updater.test.js | ç‰ˆæœ¬æ›´æ–°æµ‹è¯• |

---

## ä¾èµ– (Dependencies)

### å‰ç½®è§„æ ¼
- `scripts-consolidation.fspec.md` - åœºæ™¯æ£€æµ‹å¤ç”¨

### å¤–éƒ¨ä¾èµ–
- æ— é¢å¤–ä¾èµ–ï¼ˆä½¿ç”¨ Node.js å†…ç½®æ¨¡å—ï¼‰

### å†…éƒ¨ä¾èµ–
- `lib/hooks/scenario.js` - åœºæ™¯æ£€æµ‹

---

## æŠ€æœ¯è®¾è®¡

### è¿è¡Œæ—¶å…¥å£è¦†ç›–

**æ‰€æœ‰å…¥å£å¿…é¡»æ˜¾ç¤ºç‰ˆæœ¬å’Œåœºæ™¯**ï¼š

| å…¥å£ç±»å‹ | æ–‡ä»¶ä½ç½® | å½“å‰çŠ¶æ€ | éœ€è¦ä¿®æ”¹ |
|----------|----------|----------|----------|
| pre-commit hook | `skills/mob-seed/hooks/pre-commit` | æ˜¾ç¤ºåœºæ™¯ | æ·»åŠ ç‰ˆæœ¬å· |
| pre-push hook | `skills/mob-seed/hooks/pre-push` | æ˜¾ç¤ºåœºæ™¯ | æ·»åŠ ç‰ˆæœ¬å· |
| å‘½ä»¤å…¥å£ | `commands/*.md` | æ—  | æ·»åŠ ç‰ˆæœ¬+åœºæ™¯ |
| ç»Ÿä¸€å…¥å£ | `commands/mob-seed.md` | æ—  | æ·»åŠ ç‰ˆæœ¬+åœºæ™¯ |

### ç‰ˆæœ¬è·å–å‡½æ•°

```javascript
// lib/runtime/version-checker.js
function getLocalVersion() {
  // å››å±‚å›é€€æŸ¥æ‰¾ package.json
  const paths = [
    // Layer 1: dogfooding (mob-seed é¡¹ç›®å†…)
    'skills/mob-seed/package.json',
    // Layer 2: ç”¨æˆ·ç¯å¢ƒå˜é‡
    process.env.SEED_PLUGIN_PATH + '/package.json',
    // Layer 3: Claude Code æ’ä»¶
    path.join(os.homedir(), '.claude/plugins/mobfish-ai/mob-seed/skills/mob-seed/package.json'),
    // Layer 4: compat
    '.seed/package.json'
  ];
  // ...
}
```

### ç‰ˆæœ¬æ£€æŸ¥æµç¨‹

```
å¯åŠ¨å‘½ä»¤/hook
    â†“
è¯»å–æœ¬åœ°ç‰ˆæœ¬ (package.jsonï¼Œå››å±‚å›é€€)
    â†“
è¯»å–è¿è¡Œåœºæ™¯ (scenario.js)
    â†“
æ˜¾ç¤ºç‰ˆæœ¬å’Œåœºæ™¯ï¼ˆç»Ÿä¸€æ ¼å¼ï¼‰
    â†“
æ£€æŸ¥ç¼“å­˜æ˜¯å¦è¿‡æœŸï¼Ÿ
    â”œâ”€â”€ å¦ â†’ ä½¿ç”¨ç¼“å­˜ç‰ˆæœ¬
    â””â”€â”€ æ˜¯ â†’ å¼‚æ­¥æ£€æŸ¥è¿œç¨‹ç‰ˆæœ¬
              â†“
         æ›´æ–°ç¼“å­˜
              â†“
         å‘½ä»¤ç»“æŸåæ˜¾ç¤ºæ›´æ–°æç¤ºï¼ˆå¦‚æœ‰ï¼‰
```

### ç¼“å­˜ç»“æ„

```json
// .seed/cache/version.json
{
  "current": "3.5.0",
  "latest": "3.5.0",
  "checkedAt": "2026-01-04T12:00:00Z",
  "updateAvailable": false
}
```

### æ˜¾ç¤ºæ ¼å¼

**å‘½ä»¤å…¥å£**:
```
ğŸŒ± mob-seed v3.5.0 [å¼€å‘æ¨¡å¼] mob-seed dogfooding

... å‘½ä»¤è¾“å‡º ...

ğŸ’¡ æ–°ç‰ˆæœ¬ v3.6.0 å¯ç”¨ï¼Œè¿è¡Œ npm update mob-seed æ›´æ–°
```

**Git Hooks**:
```
ğŸ” SEED å¿«é€Ÿæ£€æŸ¥... v3.5.0 [å¼€å‘æ¨¡å¼] mob-seed dogfooding
âœ… SEED å¿«é€Ÿæ£€æŸ¥é€šè¿‡
```

---

## å˜æ›´è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ | ä½œè€… |
|------|------|----------|------|
| 1.0.0 | 2026-01-04 | åˆå§‹ç‰ˆæœ¬ | Claude |
