# Insight Import Prompt

> 用于 AI 辅助从 URL 或文本导入洞见时的提示词模板

---

## ⚠️ 核心原则：分析式导入

**洞见导入不是机械转换，而是深度分析过程。**

```
错误流程（机械式）:
用户输入 → 提取元数据 → 创建空壳文件 → 手动填充

正确流程（分析式）:
用户输入 → 配置加载 → 去重检查 → 深度分析 → 对比分析 → 生成完整洞见 → 创建文件
```

**质量标准**: 新创建的洞见必须与现有高质量洞见（如 `ins-20260114-ralph-loop-automation.md`）具有相同深度。

---

## 第〇阶段：配置加载（必须）

**导入前必须读取 `.seed/config.json`，获取可覆盖配置。**

```
读取 .seed/config.json → ace.insight 字段：
  - template:       自定义模板路径（默认: mob-seed 内置模板）
  - methodologies:  对比目标列表（默认: ["mob-seed"]）
```

**配置示例** (`.seed/config.json`):
```json
{
  "ace": {
    "insight": {
      "template": "path/to/custom-template.md",
      "methodologies": ["my-methodology-A", "my-methodology-B"]
    }
  }
}
```

**未配置时的默认行为**: 使用内置模板，对比 mob-seed 自身。
**自定义章节标题/说明文字**: 直接修改模板文件即可。

---

## 第一阶段：去重检查（必须）

**在任何分析之前，必须先检查是否已存在相似洞见。**

### 去重检查流程

```
📋 去重检查

1. 提取关键词和标签
   - 从内容中提取关键词
   - 识别核心概念（如：scaffolding, markdown, bash, context）

2. 搜索现有洞见
   - 使用 Grep 搜索关键词
   - 检查标签重叠
   - 比较标题相似度

3. 如发现相似洞见
   ├── 相似度 ≥80%: 高度相似，建议更新现有洞见
   ├── 相似度 60-80%: 可能重复，需人工确认
   └── 相似度 40-60%: 部分相关，可选择扩展或新建

4. 输出格式
   ⚠️ 发现相似洞见:

   📄 {existing_id} (相似度: {score}%)
      标题: {title}
      状态: {status}
      标签: [{tags}]

   💡 建议:
      - {suggestion}
      - 查看现有洞见: .seed/insights/{existing_id}.md
      - 如确需创建新洞见，使用 --force 参数
```

### 检查命令

```bash
# 搜索相关洞见（示例关键词）
grep -rn "scaffolding\|脚手架" .seed/insights/
grep -rn "markdown.*向量\|RAG" .seed/insights/
grep -rn "bash.*适配\|CLI" .seed/insights/
```

---

## 第二阶段：深度分析（必须）

**这是洞见质量的核心环节，不可跳过。**

### 2.1 核心概念提取

必须回答以下问题：

| 问题 | 说明 |
|------|------|
| **这是什么？** | 用 1-2 句话定义核心概念 |
| **解决什么问题？** | 明确痛点和挑战 |
| **如何解决？** | 关键技术方案或方法论 |
| **核心价值是什么？** | 最重要的收益 |

### 2.2 架构/方法论分析

根据内容类型选择分析方式：

**系统架构类**:
```
┌─────────────────────────────────────────────────────────────────┐
│                     [绘制架构图]                                 │
│                                                                  │
│    - 识别主要模块/组件                                           │
│    - 标注模块间关系                                              │
│    - 说明数据/控制流                                             │
└─────────────────────────────────────────────────────────────────┘
```

**方法论类**:
```
流程步骤:
1. [步骤1] - 说明
2. [步骤2] - 说明
3. [步骤3] - 说明

关键原则:
- 原则1
- 原则2
```

**工具/框架类**:
```
| 组件 | 职责 | 特点 |
|------|------|------|
| ... | ... | ... |
```

### 2.3 对比分析（关键）

> 对比目标从 `.seed/config.json` → `ace.insight.methodologies` 读取。
> 默认对比 mob-seed 自身；项目可 override。
> 章节格式按模板（`ace.insight.template`）定义。

### 2.4 评估笔记

对每个核心观点进行适用性评估：

| 观点 | 适用性 | 理由 |
|------|--------|------|
| 观点1 | ✅ 高度适用 / ⚡ 部分适用 / ⏸️ 需观望 / ❌ 不适用 | 详细说明 |
| 观点2 | ... | ... |

### 2.5 采纳决策

必须明确分类：

```
✅ **采纳**:
  1. [决策1] - 原因
  2. [决策2] - 原因

⏸️ **观望**:
  1. [决策1] - 原因

❌ **不采纳**:
  1. [决策1] - 原因
```

### 2.6 局限性分析

识别潜在问题：

```
1. [局限性1]: 说明
2. [局限性2]: 说明
3. [局限性3]: 说明
```

---

## 第三阶段：质量检查（必须）

**创建文件前，必须确认以下检查项全部通过：**

```
质量检查清单:

□ 核心概念清晰定义（1-2 句话能说清楚是什么）
□ 问题和痛点明确（不是泛泛而谈）
□ 架构/方法论有具体分析（图表或结构化描述）
□ 对比分析已完成（按 config.methodologies 和模板格式）
□ 评估笔记完整（每个观点都有适用性判断）
□ 采纳决策明确（分三类：采纳/观望/不采纳）
□ 局限性有识别（至少 2-3 条）
□ 可操作的下一步（潜在规格/改进方向）
□ 关联洞见已检索并链接（Grep 搜索相关 tags/关键词，用 [[wikilink]] 链接）
□ 来源追溯已链接（原文 URL/archive 的链接）
□ 元数据从原文明确提取（无推测）

⚠️ 任何检查项未通过，禁止创建文件
```

---

## 第四阶段：生成洞见文件

### 4.1 文件结构

```markdown
---
id: ins-{YYYYMMDD}-{slug}
source:
  title: "{完整标题}"
  type: {blog|expert_opinion|experience|documentation|paper|discussion|video|interview|report|article|community|ai_generated}
  author: "{作者}"
  affiliation: "{机构}"
  date: {YYYY-MM-DD}
  context: "{简要背景}"
  url: "{来源URL}"
  credibility: {high|medium|low}
  secondary_sources:
    - title: "{参考来源}"
      url: "{URL}"
date: {今天日期}
status: evaluating
model_era: claude-opus-4-6
review_trigger: manual
tags: [{标签列表}]
---

## 原始洞见

### 核心概念

**{概念名称}** 是 [简洁定义]。

### 解决的问题

[典型痛点描述]:
```
问题1 → 问题2 → 问题3
```

该洞见提供的解决方案：
```
方案1 → 方案2 → 方案3
```

### 架构设计 / 方法论

[架构图或流程描述]

### 详细分析

[各模块/步骤的详细说明]

## 评估笔记

| 观点 | 适用性 | 理由 |
|------|--------|------|
| ... | ... | ... |

### [按模板 + config.methodologies 生成对比章节]

### 可借鉴的设计

| 设计 | 价值 | 实现建议 |
|------|------|----------|
| ... | ... | ... |

### 关键洞察

1. **洞察1**
   - 详细说明

2. **洞察2**
   - 详细说明

### 潜在改进方向

1. **改进1**
   - 当前：...
   - 改进：...

### 局限性

1. **局限性1**: 说明
2. **局限性2**: 说明

## 采纳决策

- ✅ **采纳**:
  1. **决策1** - 原因

- ⏸️ **观望**:
  1. **决策1** - 原因

- ❌ **不采纳**:
  1. **决策1** - 原因

## 相关变更

### 关联洞见

{必须通过 Grep 搜索 tags/关键词，找到相关洞见并用 [[wikilink]] 链接}

- 关联洞见: [[ins-YYYYMMDD-xxx]] (简要说明关联关系)
- 关联洞见: [[ins-YYYYMMDD-yyy]] (简要说明关联关系)

### 来源追溯

- 来源: {URL}
- 原文存档: （如有 archive 文件，用 [[wikilink]] 链接）

### 潜在行动

- **潜在规格**: [可能创建的 fspec]
- **文档改进**: [需要更新的文档]
- **代码改进**: [可能的代码变更]

## 补充说明

### 项目/来源信息

- **来源**: {URL}
- **定位**: {简要定位}

### 关键引用

> "{重要引用1}"

> "{重要引用2}"

### 核心价值

总结 3-4 点核心价值。
```

---

## URL 导入流程

当用户提供 URL 时：

### 步骤 1: 去重检查
基于 URL 和预期主题进行初步检查。

### 步骤 2: 内容抓取
```
🔍 正在抓取: {url}
```

### 步骤 3: 元数据提取

| 字段 | 提取策略 | 备注 |
|------|----------|------|
| 标题 | og:title > title > h1 | 优先级从高到低 |
| 作者 | meta author > article:author | 可能缺失 |
| 机构 | og:site_name > publisher | 可能缺失 |
| 日期 | article:published_time > time | 默认今天 |
| 类型 | 根据域名推断 | 见类型映射表 |
| 可信度 | 根据来源评估 | 见可信度评估 |
| 标签 | meta keywords + 内容分析 | 自动生成 |

### 步骤 4: 深度分析（必须）
执行第二阶段的完整分析。

### 步骤 5: 质量检查（必须）
执行第三阶段的检查清单。

### 步骤 6: 生成文件
按第四阶段的结构生成完整洞见。

---

## 文本导入流程

当用户使用 `--text` 模式时：

### 步骤 1: 引导输入

```
📝 请粘贴洞见内容：

> 粘贴后按 Enter 两次结束输入
```

### 步骤 2: 去重检查
从文本中提取关键词，搜索现有洞见库。

### 步骤 3: 来源信息收集

```
📋 请提供来源信息:

1. 来源类型:
   [ ] blog - 技术博客/文章
   [ ] expert_opinion - 专家意见
   [ ] experience - 实践经验
   [ ] documentation - 官方文档
   [ ] paper - 学术论文
   [ ] discussion - 社区讨论
   [ ] video - 视频内容
   [ ] interview - 采访/对话
   [ ] report - 行业报告
   [ ] article - 新闻/综合文章
   [ ] community - 社区生态内容
   [ ] ai_generated - AI 生成

2. 作者 (可选): _______________

3. 日期 (YYYY-MM-DD，可选): _______________

4. 可信度:
   [ ] high - 权威来源
   [ ] medium - 需要验证
   [ ] low - 未验证

5. 标签 (逗号分隔，可选): _______________
```

### 步骤 4: 深度分析（必须）

**这是最关键的步骤。AI 必须：**

1. 阅读并理解输入内容
2. 提取核心概念和方法论
3. 分析架构或流程
4. **对比分析**（按 config.methodologies）
5. 评估每个观点的适用性
6. 做出采纳决策
7. 识别局限性

### 步骤 5: 质量检查（必须）

确认所有检查项通过后才能继续。

### 步骤 6: 确认并创建

```
📋 洞见分析完成，确认创建？

   标题: {title}
   核心概念: {concept}
   对比分析: {relation}
   采纳决策: {decisions}

确认创建? [Y/n]
```

---

## 文件导入流程 (--file)

当用户使用 `--file <path>` 从本地文件导入时：

### 步骤 1: 文件验证

```
📂 正在读取文件: {path}
```

**验证检查**:
- [ ] 文件存在
- [ ] 文件可读
- [ ] 文件大小合理（< 1MB）
- [ ] 文件类型支持（.md, .txt, .json）

### 步骤 2: 内容解析

| 文件类型 | 解析策略 | 备注 |
|---------|----------|------|
| `.md` | 提取正文内容 | 移除 frontmatter |
| `.txt` | 读取全部内容 | 按原文处理 |
| `.json` | 提取 `content` 或 `text` 字段 | 支持 JSON 结构 |

### 步骤 3: 元数据提取

**自动提取策略**:

| 字段 | 提取策略 | 备用方案 |
|------|----------|----------|
| 标题 | 文件首行（# 标题） | 文件名 |
| 来源类型 | 文件名推断 | documentation |
| 日期 | 文件修改时间 | 今天 |
| 标签 | 文件名关键词 | 需手动指定 |

### 步骤 4: 错误处理

**文件不存在**:
```
❌ 文件不存在: {file_path}

💡 建议检查:
   - 文件路径是否正确
   - 使用相对路径或绝对路径
   - 确认文件确实存在
```

**文件类型不支持**:
```
❌ 不支持的文件类型: {extension}

支持的格式: .md, .txt, .json
```

**文件过大**:
```
❌ 文件过大: {size} MB (限制: 1MB)

💡 建议: 分割文件或使用 --text 模式手动输入
```

### 步骤 5: 去重检查

从文件内容和标题中提取关键词，搜索现有洞见库：

```bash
# 基于文件名搜索
grep -rn "{filename_keywords}" .seed/insights/

# 基于内容关键词搜索
grep -rn "{content_keywords}" .seed/insights/
```

### 步骤 6: 来源信息收集（如需补充）

```
📋 文件元数据已提取:

   标题: {title}
   类型: {type}
   日期: {date}
   标签: {tags}

如需补充来源信息，请提供:
   1. 作者 (可选): _______________
   2. 机构 (可选): _______________
   3. 可信度 (high/medium/low): _______________
   4. 额外标签 (逗号分隔): _______________
```

### 步骤 7: 深度分析（必须）

执行完整的第二阶段分析流程：
1. 核心概念提取
2. 架构/方法论分析
3. **对比分析**（按 config.methodologies）
4. 评估笔记
5. 采纳决策
6. 局限性分析

### 步骤 8: 质量检查（必须）

确认所有检查项通过。

### 步骤 9: 快捷用法

```bash
# 从文件导入
/mob-seed:insight --file /path/to/file.md

# 预览模式
/mob-seed:insight --file /path/to/file.md --dry-run

# 指定标签
/mob-seed:insight --file /path/to/file.md --tags "ai,coding"
```

### 步骤 10: 确认并创建

```
📋 洞见分析完成，确认创建？

   来源文件: {file_path}
   标题: {title}
   核心概念: {concept}
   对比分析: {relation}
   采纳决策: {decisions}

确认创建? [Y/n]
```

### 支持的文件格式

| 格式 | 说明 | 示例 |
|------|------|------|
| Markdown (.md) | 标准 markdown 文件 | `notes/insight.md` |
| Text (.txt) | 纯文本文件 | `notes/article.txt` |
| JSON (.json) | 包含 content 字段的 JSON | `export/insight.json` |

### JSON 格式规范

```json
{
  "title": "洞见标题",
  "content": "洞见正文内容...",
  "author": "作者（可选）",
  "affiliation": "机构（可选）",
  "tags": ["tag1", "tag2"],
  "credibility": "high"
}
```

---

## 类型映射

| 域名模式 | 来源类型 |
|----------|----------|
| arxiv.org, nature.com, science.org | paper |
| docs.*.com, developer.mozilla.org | documentation |
| medium.com, dev.to, *.blog.* | blog |
| twitter.com, reddit.com, news.ycombinator.com | discussion |
| speakerdeck.com, youtube.com | expert_opinion |

## 可信度评估

| 来源特征 | 可信度 | 说明 |
|----------|--------|------|
| 学术期刊、官方文档 | high | 经过同行评审或官方维护 |
| 知名技术博客、专业社区 | medium | 需要验证但通常可靠 |
| 社交媒体、匿名来源 | low | 需要严格验证 |

---

## 预览模式 (--dry-run)

在实际创建文件前预览分析结果：

```
📋 预览模式 (Dry Run)

=== 深度分析结果 ===

核心概念: {concept}
解决问题: {problem}
架构分析: {architecture_summary}

=== 对比分析 ===
{comparison_table}

=== 采纳决策 ===
采纳: {adopt_count} 项
观望: {wait_count} 项
不采纳: {reject_count} 项

⚠️ 这是预览，未创建实际文件
   移除 --dry-run 参数以创建文件
```

---

## 错误处理

### URL 无法访问

```
❌ 无法抓取 URL: {error}

💡 可能的原因:
   - 网络连接问题
   - URL 需要登录访问
   - 网站阻止了抓取

建议: 使用 --text 模式手动输入内容
```

### 质量检查未通过

```
❌ 质量检查未通过

缺失内容:
   - [ ] 对比分析
   - [ ] 采纳决策

请补充以上内容后重新创建。
```

### 重复洞见

```
❌ 洞见已存在: {insight_id}

现有洞见位置: {existing_file_path}

💡 如需更新，请直接编辑现有文件
```

---

## 快捷用法

```bash
# 从 URL 快速导入
/mob-seed:insight "https://example.com/article"

# 预览模式（查看分析结果但不创建文件）
/mob-seed:insight "https://example.com/article" --dry-run

# 文本导入
/mob-seed:insight --text

# 带标签导入
/mob-seed:insight "https://..." --tags "ai,coding"
```

---

## 质量参考

高质量洞见示例：
- `ins-20260114-ralph-loop-automation.md` - 完整的评估笔记和对比分析
- `ins-20260115-google-stitch-ai-studio-workflow.md` - 深度研究验证和对比分析

创建新洞见时，应以这些文件的深度和结构为参考标准。
